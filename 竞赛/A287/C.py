from typing import List


class Solution:
    def maximumCandies(self, candies: List[int], k: int) -> int:
        s = sum(candies)
        target = s // k
        left = 0
        right = target + 1
        ans = 0
        while left <= right:
            mid = ((right - left) // 2) + left
            if self.f(candies, mid, k):
                ans = mid
                left = mid + 1
            else:
                right = mid - 1
        return ans

    def f(self, candies, target, k):
        res = sum([c // target for c in candies if target != 0])
        return res >= k

if __name__ == '__main__':
    solution = Solution()
    # candies = [312413,746822,811173,311276,191516,136651,873287,267210,215887,628774,466174,855342,793183,658703,783942,183169,357998,111210,595945,524886,198085,790932,318997,120574,852612,486079,402689,753623,598675,482968,897932,685896,190538,682631,889696,272117,520511,274034,398897,318985,485516,326587,693896,428887,869477,609794,736816,744417,624771,764708,231434,146932,880585,642025,486647,387531,110955,698730,415185,546999,575489,768496,769156,365434,323568,815799,466343,785452,835831,745887,893286,163167,179700,798143,204613,763838,777351,654714,645010,761877,733196,857350,185279,538409,502250,337966,449067,433307,392060,731005,395350,670550,565590,452929,628818,702533,227447,469517,676900,848771,513077,272804,686753,539402,435053,323238,805524,720409,585103,743969,425637,642416,698704,136284,414377,652459,207579,226631,775463,878710,370639,838481,662076,348329,881408,338070,325765,837931,786632,483149,896315,716717,700041,479085,375732,522555,114468,102494,532002,105451,302157,126074,243474,472499,187312,127287,782820,565601,641108,890749,633615,829601,715897,354721,728580,776412,286026,420772,772278,300989,597299,811733,840653,315999,434482,897386,285010,106646,781970,409454,265517,565548,155307,887084,427559,332847,311001,813436,555770,688310,222720,880242,850951,464503,462803,582108,474922,490193,225139,787635,835731,134059,367883,350464,455297,354024,289709,848303,121964,467506,107369,167152,186364,428062,202885,331049,412438,464138,257900,414012,445723,485168,753038,199899,855871,242961,518584,508939,263801,652086,850096,828235,836253,882473,731561,764837,353492,394070,453915,818967,226440,489958,630192,636667,618410,171045,134897,343245,131015,640316,196931,715842,681413,171087,885994,310792,164784,393332,189175,313291,424242,257893,592227,232088,802174,492386,775119,556919,776375,199175,790722,557197,476967,690896,326754,266092,425100,326901,192011,452857,101759,669568,571665,798835,642163,747891,344103,319141,510277,734754,233620,526577,791486,793807,808028,134599,184333,113087,564625,574552,415629,626099,133304,640646,334583,648286,173780,118615,849588,134631,220543,210819,269060,553612,586900,100049,301024,519180,703176,182382,352459,443060,614853,826553,317857,497922,506558,616331,732911,246844,836737,823653,833565,453135,546939,748721,426219,505418,635763,408534,151111,861266,287641,738036,498415,644481,785183,357750,161460,419684,534709,577020,359504,413509,411203,484099,681373,608604,425255,374610,895030,702987,862513,148324,529375,279065,629397,585250,708760,622221,352976,664769,423183,207655,836783,507815,309147,893236,328554,332800,280520,822515,151331,552734,655023,833632,392735,217338,148478,648249,321147,814603,422947,887744,800012,674039,748827,711349,631753,304954,181049,891693,303333,724435,862822,691556,214728,244122,721167,608447,832161,133241,430225,304779,808007,806398,647688,870501,514867,452315,488184,482058,796767,644967,665902,614011,819859,328953,829221,168315,365053,199707,693725,125772,549659,448556,705770,137975,387144,473792,598699,121740,298575,373999,574586,234779,748698,363621,799777,104854,215247,209816,116281,485697,349236,637164,523187,864658,654954,457021,565011,248074,123248,132552,442901,354184,611305,496347,111483,687821,259833,830106,236003,170572,485492,286980,829984,546196,262662,835567,325124,565566,513354,477933,795975,610863,247363,121709,688523,873476,650069,165715,697361,894833,174764,360213,547500,467577,368690,626826,346149,839634,342331,390540,551492,889091,605169,615236,295946,156281,836882,669659,328949,840280,766705,304556,151604,317047,303151,121789,123755,762302,883341,520457,325545,553889,629819,648389,338479,463439,249561,201369,130398,829938,609092,874768,773954,766178,865181,540585,122417,362587,519384,897898,888611,480184,424397,556614,299116,830997,450252,817083,899196,734330,644790,333520,280577,559153,502091,289555,671457,210783,403869,841961,512603,817274,202518,452047,636719,627799,584350,840853,698776,178861,844587,655270,259707,370499,397002,579851,640674,631228,495942,408842,352481,549959,215136,826348,515385,644198,363851,706755,252993,270205,668320,394600,469966,209450,185823,701165,396651,349865,756506,125895,431775,635157,349493,154093,676103,791720,442033,726821,839359,734078,134630,242294,294416,404625,452317,443702,696201,176034,646228,674153,603356,850420,353860,804856,456079,855304,147564,233484,230587,381647,546474,419726,291182,675381,758479,162802,478510,615640,560669,540393,318934,879257,831054,629691,899470,288227,579330,136288,809003,537182,827848,242414,615375,392358,268422,283071,553467,537679,160067,440736,297351,133260,414719,830720,592749,767197,598951,837363,840246,151842,742226,118080,709347,398893,672122,716012,251547,849085,728129,826878,570291,449469,531219,727447,125282,330714,655361,301919,153577,200089,610602,365053,207192,726285,843756,744989,380935,858999,765032,704466,852324,454297,814269,483077,178568,875939,508467,403205,534513,738285,391111,407642,153666,622514,432184,725870,578327,627406,797015,590256,220211,613014,386767,664988,244593,135247,609177,293447,488237,794912,539049,419419,524132,831051,187757,614801,540317,684309,433290,126441,587128,373078,293532,562193,723592,724626,829903,516369,663559,507351,616061,677393,540968,222174,174697,667473,578785,173829,191639,572264,700934,432677,539819,245158,490299,644195,796934,417746,707127,806151,277803,628376,680101,324069,756865,568477,802244,816715,355152,836097,451278,579515,393000,298619,500941,708236,657026,467170,467987,326950,611323,490571,637904,357003,529111,447949,157486,505294,855178,764861,541322,684963,869344,222036,721856,509070,468284,709899,371248,256880,607613,225806,405871,226119,751128,572990,591718,570753,606525,590728,181986,768879,168708,610810,807318,273852,509835,655998,434288,654757,322075,584024,856060,896825,603909,888748,500050,423602,873861,527773,138415,413640,230689,554152,665102,364637,564814,330545,447603,458414,348317,811042,184510,469937,527655,151602,591227,208486,146080,767118,322667,608230,727361,767999,384513,200838,171703,601566,876569,600806,723965,662885,219272,635621,732490,366560,539824,186894,877638,710847,400928,648185,361206,194043,542224,538220,115349,280681,410577,120932,643278,518952,556640,896303,620931,241070,597072,791778,319511,633323,795391,792206,737619,298674,109430,194425,522676,459239,123902,434995,888782,654377,142303,440039,111557,669296,888485,566033,866750,419815,483030,750178,572788,600281,724831,486361,140489,477571,284488,465253,809685,598665,495456,122468,450612,716338,445813,496267,309890,378679,889469,605514,419061,110953,426192,626981,212071,380876,382988,111731,766707,737605,180716,609035,747249,866580,185637,781988,832783,371696,277333,694448,452741,392639,759564,413579,671619,359081,797956,459464,205758,813051,877340,530266,878091,414154,607515,884405,596560,456243,826955,272831,726233,418830,276661,891881,308158,797941,872417,363580,399190,647242,546686,756508,718002,111850,890398,346145,480449,107115,269103,856355,790563,658002,746039,641992,731288,319141,180072,330730,184517,256713,261674,568033,842229,376624,881650,311412,658835,164455,567076,617450,863703,778525,443205,587671,456504,320563,495585,837065,469058,105721,817459,166106,480887,182384,718158,800143,662072,502700,707148,780369,664662,455612,599150,541786,801949,310493,244362,467403,594874,108315,507343,248685,274435,438183,612855,791542,138174,236004,361196,104656,826329,732407,752894,755034,198329,104647,475118,410416,688710,583157,726295,246722,407614,847200,663400,730173,364116,531539,244823,647162,333410,202813,348469,249908,412601,429197,148030,654671,826649,280540,636416,773478,191499,616763,747939,636643,181541,464759,496970,732540,380351,646560,796363,489516,161326,330912,612370,605179,532077,173040,700997,219207,182278,440240,328675,401645,683613,580770,793772,711964,801817,889460,596027,250255,682182,869918,828791,121672,177197,464595,187998,129724,370256,592285,777998,619012,527304,147875,459825,665610,456982,493184,422815,192242,591717,566931,177875,798007,407951,735774,557484,686831,533612,611273,467190,574877,168099,645045,173477,699791,351962,523001,286647,805256,219441,198664,802854,655176,249891,145454,424533,815707,665132,151520,608276,377086,642924,552074,886284,291828,781555,600366,475289,659036,809351,769202,803460,144967,801038,801110,766434,223712,548260,466422,467880,105593,428323,206375,167886,296310,743325,117574,552026,892067,399833,855337,649845,245999,847924,632325,307865,800099,463260,294846,516130,347386,136146,662650,240540,484372,365137,881389,649874,518288,629272,236757,183235,804239,645987,639368,731896,369722,202903,368011,323677,623327,871769,661923,115157,732253,404257,254248,449305,559580,632994,521133,147353,162909,853311,282305,431914,339653,252296,357842,628111,410196,851998,614260,194527,125026,817248,741401,474447,532065,288158,767892,358810,196609,189157,194830,388166,888295,798593,869478,110741,806883,719115,755947,365147,248626,316229,207785,449876,584017,863648,296903,318200,128599,328062,312966,381775,772111,147363,753745,616165,528219,724209,439215,244252,821449,458113,525512,345257,527589,212972,589928,836394,274574,660945,720561,342893,707712,516179,371461,660404,640861,625239,170800,277179,230156,764108,599440,271527,526586,339744,895595,478999,399631,523977,509680,811113,190633,521727,778520,648184,489261,712386,663904,440784,856222,195587,437939,194402,177477,340610,229917,343513,739441,199995,657658,302655,868873,432837,860495,154595,645464,270349,263025,622648,245614,406578,609090,370237,877579,143109,494419,110718,884445,228993,416892,205913,715908,842631,197512,897308,201410,888940,688539,394509,753788,722772,576882,462088,132724,803078,301908,627422,634005,840925,214378,629371,134673,622935,829071,213830,852170,747142,173404,557481,486645,595037,459221,234364,838055,776050,761612,338853,294106,160437,470047,162585,713965,454670,852211,168936,490957,409135,374863,727991,318723,706816,684920,127529,840916,860870,350964,733532,814823,578583,559122,250170,107385,202241,130587,422258,202893,274903,514502,801512,445752,650322,712306,646003,514267,859784,793651,694717,593260,752542,355083,896156,373954,227192,439158,647614,860378,701919,783531,352608,410487,560733,378503,688995,816080,106028,505529,834233,720120,286807,609686,554279,847320,763750,830727,147819,497662,891772,130635,206050,433513,282102,883757,132974,697918,804165,366161,548046,193361,808140,485618,532721,513433,866683,232032,381970,114019,610322,727524,875267,526521,718857,144910,792434,332009,282022,214574,573848,242789,463958,693476,521594,787705,594964,577752,430795,102938,339733,204682,388993,189312,159367,654252,457067,767007,703286,161666,384867,114438,412212,167117,356367,394693,492970,841448,226339,852136,696719,278809,702486,238064,487609,742207,187645,890305,242345,101976,369300,477024,455122,591402,311707,742332,497745,880887,468592,444020,856487,728071,103625,462034,474433,126663,387632,627399,148406,158693,206706,479407,474951,230865,506236,646925,603495,555815,474845,797950,886195,677785,472302,488290,157369,467202,515464,545002,241294,843029,355452,841096,262831,540226,337778,723704,538968,373885,173869,572611,719576,164437,369512,897228,108404,506088,772758,434366,782232,274874,140829,840028,827607,775162,231660,653453,354172,310767,754808,336887,471808,364625,844924,596977,442148,363415,144472,215088,115844,685556,825703,624644,315985,479945,828703,555617,375468,761025,375937,766078,296809,438775,893081,505493,101645,330190,567931,518062,274319,448925,489619,731621,111659,139249,894752,597085,724334,223810,344926,234782,532084,504836,414034,644433,387461,167415,510403,184423,391145,769112,455263,229187,397586,713000,185060,437575,895914,795952,172312,483233,645848,524448,547415,632224,892761,318196,851339,196869,767474,289328,236920,160907,818796,202378,456575,798376,836820,659529,590045,624109,571754,524558,895277,605060,546475,127276,364828,304204,259091,416749,562945,752386,301540,481973,415479,477478,694545,819993,617967,236146,553563,592569,306638,721212,782077,513798,276540,873876,494672,738829,716934,578460,631908,857808,479751,543634,821017,392983,846926,402568,853536,704882,248339,234484,139771,412921,790525,668459,896516,545210,323378,640160,611200,548020,276777,341567,529110,148920,454012,786602,358001,200459,791324,827749,278305,721389,102947,507231,695436,189695,293213,391126,534291,275316,574428,566138,195215,180498,502614,153484,463054,134700,244079,438130,184373,284349,553757,136231,513571,279918,278310,870527,241091,722085,218301,229566,448995,674761,816427,622966,509356,671569,587636,657894,610753,855907,183307,208846,690613,262714,486892,633350,563919,254395,657634,688798,272822,862665,623291,713239,692686,807418,280641,329752,509897,281197,857705,672041,877408,639939,711047,741938,128707,152674,862297,489085,601520,805216,523068,669239,139989,298991,508999,154118,433230,147182,196720,298723,283603,193989,318943,517932,672911,102695,300578,124788,186205,650351,784902,336417,754770,761947,474980,243431,810290,338846,847688,222461,530843,675991,527267,879718,141882,515921,321276,464264,833403,794813,476958,559654,671321,689768,737227,778872,867606,319753,734627,702465,491010,733609,109000,483076,521993,725293,326956,664298,304745,181260,446299,733784,448810,248300,458390,133284,117791,702581,194396,629706,456981,550876,494997,761600,673821,691622,593421,820409,425455,490331,290363,476282,125970,336910,270570,164886,742663,422675,652353,604021,629169,438966,604669,816757,373886,166704,204126,447327,488919,455004,123897,120920,899919,191637,173950,684095,805151,231462,251782,888032,557115,646137,452525,597689,871919,823555,869556,291547,505061,577783,832423,115083,556953,207897,497918,145344,475180,698827,118121,268814,137333,131418,536590,471702,570330,862471,887795,487441,711342,307258,220919,371735,106479,583428,150473,872269,588060,409305,380137,283121,237231,473314,308190,547872,665228,196776,291329,390004,360426,497164,316988,195689,852427,401133,802153,551690,354085,227730,282783,668203]
    # k = 2201
    candies = [4, 7, 5]
    k = 16
    res = solution.maximumCandies(candies, k)
    print(res)